---
title: 'ä½¿ç”¨æŒ‡å—'
description: 'ä½¿ç”¨ Nuxt è½»æ¾å®ç°è‡ªåŠ¨æ£€æµ‹çš„æ·±è‰²å’Œæµ…è‰²æ¨¡å¼ ğŸŒ—'
aside: false
navigation: false
---

# Nuxt é¢œè‰²æ¨¡å¼

ä½¿ç”¨ Nuxt è½»æ¾å®ç°è‡ªåŠ¨æ£€æµ‹çš„æ·±è‰²å’Œæµ…è‰²æ¨¡å¼ ğŸŒ—

## ç‰¹æ€§

- æ”¯æŒ Nuxt 3 å’Œ Nuxt Bridge
- ä¸º `<html>` æ·»åŠ  `.${color}-mode` ç±»ä»¥ä¾¿äº CSS ä¸»é¢˜åŒ–
- å¼ºåˆ¶é¡µé¢ä½¿ç”¨ç‰¹å®šé¢œè‰²æ¨¡å¼ï¼ˆéå¸¸é€‚åˆå¢é‡å¼€å‘ï¼‰
- é€‚ç”¨äºå®¢æˆ·ç«¯å’Œé€šç”¨æ¸²æŸ“
- ä¸ [@nuxtjs/tailwindcss](https://github.com/nuxt-modules/tailwindcss) ç›´æ¥å…¼å®¹
- è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿ [é¢œè‰²æ¨¡å¼](https://drafts.csswg.org/mediaqueries-5/#descdef-media-prefers-color-mode)
- æ”¯æŒ IE9+ ğŸ‘´

## ç°åœºæ¼”ç¤º

[![Nuxt é¢œè‰²æ¨¡å¼æ¼”ç¤º](/demo.gif){.border-b .border-r}](https://color-mode.nuxtjs.app) 

æŸ¥çœ‹ [åœ¨çº¿æ¼”ç¤º](https://color-mode.nuxtjs.app) å’Œ [æºä»£ç ](https://github.com/nuxt-modules/color-mode/tree/main/playground)ã€‚

## è®¾ç½®

::alert{type="info"}
`@nuxtjs/color-mode` å½“å‰ç‰ˆæœ¬ä¸ [Nuxt 3 å’Œ Nuxt Bridge](https://nuxt.com) å…¼å®¹ã€‚ :br å¦‚æœä½ æ­£åœ¨å¯»æ‰¾æ­¤æ¨¡å—çš„æ—§ç‰ˆæœ¬ï¼Œè¯·æŸ¥çœ‹ [v2.color-mode.nuxtjs.org](https://v2.color-mode.nuxtjs.org/)ï¼Œæˆ– [é˜…è¯»æœ‰å…³å·®å¼‚çš„æ›´å¤šä¿¡æ¯](#è¿ç§»åˆ°-v3)ã€‚
::

å‘ä½ çš„é¡¹ç›®æ·»åŠ  `@nuxtjs/color-mode` ä¾èµ–é¡¹ï¼š
```bash
npx nuxi@latest module add color-mode
```

ç„¶åï¼Œåœ¨ `nuxt.config.ts` çš„ `modules` éƒ¨åˆ†æ·»åŠ  `@nuxtjs/color-mode`ï¼š

```ts [nuxt.config.ts]
export default defineNuxtConfig({
  modules: [
    '@nuxtjs/color-mode'
    // '@nuxtjs/tailwindcss'
  ]
})
```

ä½ å·²å‡†å¤‡å¥½ä½¿ç”¨ `.dark-mode` å’Œ `.light-mode` ç±»å¼€å§‹å¯¹ä½ çš„ CSS è¿›è¡Œä¸»é¢˜åŒ– âœ¨

## ä½¿ç”¨æ–¹æ³•

ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ `useColorMode()` æˆ–è€…ç›´æ¥åœ¨æ¨¡æ¿ä¸­è®¿é—® `$colorMode` æ¥è®¿é—®é¢œè‰²æ¨¡å¼åŠ©æ‰‹ã€‚æ­¤åŠ©æ‰‹å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š

- `preference`: å®é™…é€‰æ‹©çš„é¢œè‰²æ¨¡å¼ï¼ˆå¯ä»¥æ˜¯ `'system'`ï¼‰ï¼Œæ›´æ–°å®ƒä»¥æ”¹å˜ç”¨æˆ·é¦–é€‰çš„é¢œè‰²æ¨¡å¼
- `value`: å½“ `$colorMode === 'system'` æ—¶ï¼Œæœ‰åŠ©äºäº†è§£å·²æ£€æµ‹åˆ°çš„é¢œè‰²æ¨¡å¼ï¼Œä½ ä¸åº”è¯¥æ›´æ–°å®ƒ
- `unknown`: å¦‚æœåœ¨ SSR æˆ– Generate æœŸé—´ï¼Œæˆ‘ä»¬éœ€è¦æ¸²æŸ“ä¸€ä¸ªå ä½ç¬¦
- `forced`: å¦‚æœå½“å‰é¢œè‰²æ¨¡å¼æ˜¯ç”±å½“å‰é¡µé¢å¼ºåˆ¶çš„ï¼ˆæœ‰åŠ©äºéšè—é¢œè‰²é€‰æ‹©å™¨ï¼‰

```html [pages/index.vue]
<template>
  <div>
    <h1>é¢œè‰²æ¨¡å¼ï¼š{{ $colorMode.value }}</h1>
    <select v-model="$colorMode.preference">
      <option value="system">ç³»ç»Ÿ</option>
      <option value="light">æµ…è‰²</option>
      <option value="dark">æ·±è‰²</option>
      <option value="sepia">æ£•è¤è‰²</option>
    </select>
  </div>
</template>

<script setup>
const colorMode = useColorMode()

console.log(colorMode.preference)
</script>

<style>
body {
  background-color: #fff;
  color: rgba(0,0,0,0.8);
}
.dark-mode body {
  background-color: #091a28;
  color: #ebf4f1;
}
.sepia-mode body {
  background-color: #f1e7d0;
  color: #433422;
}
</style>
```

## å¼ºåˆ¶é¢œè‰²æ¨¡å¼

ä½ å¯ä»¥é€šè¿‡è®¾ç½® `colorMode` å±æ€§åœ¨é¡µé¢çº§åˆ«ï¼ˆä»…é™çˆ¶çº§ï¼‰å¼ºåˆ¶é¢œè‰²æ¨¡å¼ï¼š

```html [pages/light.vue]
<template>
  <h1>æ­¤é¡µé¢å¼ºåˆ¶ä½¿ç”¨æµ…è‰²æ¨¡å¼</h1>
</template>

<script>
// å¯¹äº Nuxt Bridge
export default {
  colorMode: 'light',
}
// å¯¹äº Nuxt 3
definePageMeta({
  colorMode: 'light',
})
</script>
```

è¿™ä¸ªç‰¹æ€§éå¸¸é€‚åˆé€šè¿‡å°†æœªå‡†å¤‡å¥½çš„é¡µé¢è®¾ç½®ä¸º `colorMode: 'light'` æ¥é€æ­¥å®ç°ç½‘ç«™çš„æ·±è‰²æ¨¡å¼ã€‚

::alert{type="info"}
æˆ‘ä»¬å»ºè®®åœ¨é¡µé¢ä¸Šéšè—æˆ–ç¦ç”¨é¢œè‰²æ¨¡å¼é€‰æ‹©å™¨ï¼Œå› ä¸ºå®ƒå°†æ— æ³•æ”¹å˜å½“å‰é¡µé¢çš„é¢œè‰²æ¨¡å¼ï¼Œä½¿ç”¨ `$colorMode.forced` å€¼ã€‚
::

## é…ç½®

ä½ å¯ä»¥é€šè¿‡åœ¨ `nuxt.config.js` ä¸­æä¾› `colorMode` å±æ€§æ¥é…ç½®æ¨¡å—ï¼›è¿™é‡Œæ˜¯é»˜è®¤é€‰é¡¹ï¼š

```js{}[nuxt.config.js]
import { defineNuxtConfig } from 'nuxt'

export default defineNuxtConfig({
  modules: ['@nuxtjs/color-mode'],
  colorMode: {
    preference: 'system', // $colorMode.preference çš„é»˜è®¤å€¼
    fallback: 'light', // å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç³»ç»Ÿåå¥½è®¾ç½®ï¼Œåˆ™å›é€€å€¼
    hid: 'nuxt-color-mode-script',
    globalName: '__NUXT_COLOR_MODE__',
    componentName: 'ColorScheme',
    classPrefix: '',
    classSuffix: '-mode',
    storageKey: 'nuxt-color-mode'
  }
})
```

æ³¨æ„ï¼š
- `'system'` æ˜¯ä¸€ä¸ªç‰¹æ®Šå€¼ï¼›å®ƒå°†æ ¹æ®ç³»ç»Ÿåå¥½è‡ªåŠ¨æ£€æµ‹é¢œè‰²æ¨¡å¼ï¼ˆè§ [prefers-color-mode è§„èŒƒ](https://drafts.csswg.org/mediaqueries-5/#descdef-media-prefers-color-mode)ï¼‰ã€‚æ³¨å…¥çš„å€¼å°†æ˜¯ `'light'` æˆ– `'dark'`ã€‚å¦‚æœæ£€æµ‹åˆ° `no-preference` æˆ–æµè§ˆå™¨ä¸æ”¯æŒé¢œè‰²æ¨¡å¼ï¼Œå®ƒå°†è®¾ç½® `fallback` å€¼ã€‚
- å¯é€‰çš„ `dataValue` å…è®¸ä½ åœ¨ `html` ä¸Šæ·»åŠ æ•°æ®é›†ï¼Œä¾‹å¦‚å¦‚æœä½ ç›®å‰åœ¨ `html` ä¸Šæœ‰ `class="dark"`ï¼Œ`dataValue: 'theme'` ä¹Ÿå°†åœ¨ `html` ä¸Šè®¾ç½® `data-theme="dark"`ã€‚å½“ä½ ä½¿ç”¨åƒ daisyUI è¿™æ ·çš„åº“æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ï¼Œå®ƒä½¿ç”¨ `data-theme="light"` åœ¨ `html` ä¸Šåº”ç”¨ä¸»é¢˜ã€‚

## æ³¨æ„äº‹é¡¹

å½“ `$colorMode.preference` è®¾ç½®ä¸º `'system'` æ—¶ï¼Œåœ¨ Vue æ¨¡æ¿ä¸­ä½¿ç”¨ `$colorMode` ä¼šå¯¼è‡´é—ªçƒã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨é¢„æ¸²æŸ“é¡µé¢æ—¶æ— æ³•çŸ¥é“ç”¨æˆ·åå¥½ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨å®¢æˆ·ç«¯æ£€æµ‹åˆ°çš„ã€‚

ä¸ºäº†é¿å…é—ªçƒï¼Œä½ å¿…é¡»ä½¿ç”¨ `$colorMode.unknown` ä¿æŠ¤ä»»ä½•ä¾èµ–äº `$colorMode` çš„æ¸²æŸ“è·¯å¾„ï¼Œä»¥æ¸²æŸ“ä¸€ä¸ªå ä½ç¬¦æˆ–ä½¿ç”¨æˆ‘ä»¬çš„ `<ColorScheme>` ç»„ä»¶ã€‚

**ç¤ºä¾‹ï¼š**

```vue
<template>
  <ColorScheme placeholder="..." tag="span">
    é¢œè‰²æ¨¡å¼ï¼š<b>{{ $colorMode.preference }}</b>
    <span v-if="$colorMode.preference === 'system'">(<i>{{ $colorMode.value }}</i> æ¨¡å¼å·²æ£€æµ‹åˆ°)</span>
  </ColorScheme>
</template>
```

å±æ€§ï¼š
- `placeholder`: `String`
- `tag`: `String`ï¼Œé»˜è®¤å€¼ï¼š`'span'`

## è¿ç§»åˆ° v3

`@nuxtjs/color-mode` çš„ v3 ç‰ˆæœ¬éœ€è¦ Nuxt Bridge æˆ– Nuxt 3ã€‚ï¼ˆå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ä¸å¸¦ Bridge çš„ Nuxt 2ï¼Œä½ åº”è¯¥ç»§ç»­ä½¿ç”¨ v2ã€‚ï¼‰

1. Nuxt 2 -> Nuxt 3 ä¹‹é—´çš„ä¸»è¦å˜åŒ–æ˜¯ï¼Œä½ å°†ä½¿ç”¨ `definePageMeta` åœ¨é¡µé¢çº§åˆ«å®šä¹‰ä½ çš„é¢œè‰²æ¨¡å¼ï¼š

```diff
<template>
  <h1>æ­¤é¡µé¢å¼ºåˆ¶ä½¿ç”¨æµ…è‰²æ¨¡å¼</h1>
</template>

- <script>
- export default {
-   colorMode: 'light',
- }
+ <script setup>
+ definePageMeta({
+   colorMode: 'light',
+ })
</script>
```

âš ï¸ å¦‚æœä½ ä½¿ç”¨ Nuxt Bridgeï¼Œä½ ä¸åº”è¯¥ä½¿ç”¨ `definePageMeta` è€Œæ˜¯ç»§ç»­ä½¿ç”¨ç»„ä»¶é€‰é¡¹ `colorMode`ã€‚

2. `$colorMode` åŠ©æ‰‹ä¿æŒä¸å˜ï¼Œä½†ç°åœ¨è¿˜æœ‰ä¸€ä¸ªæ–°ç»„åˆå‡½æ•° (`useColorMode`)ï¼Œè¿™æ˜¯è®¿é—®é¢œè‰²æ¨¡å¼ä¿¡æ¯çš„æ¨èæ–¹å¼ã€‚

3. å¦‚æœä½ ä¹‹å‰ç›´æ¥å¯¼å…¥äº†é¢œè‰²æ¨¡å¼é…ç½®ç±»å‹ï¼Œè¯·æ³¨æ„è¿™å·²ç»é‡å‘½åä¸º `ModuleOptions`ã€‚

## è´¡çŒ®

ä½ å¯ä»¥åœ¨çº¿ä½¿ç”¨ CodeSandBox è´¡çŒ®æ­¤æ¨¡å—ï¼š

[![Edit @nuxtjs/color-mode](https://codesandbox.io/static/img/play-codesandbox.svg)](https://codesandbox.io/s/github/nuxt-modules/color-mode/tree/main/?fontsize=14&hidenavigation=1&theme=dark) 

æˆ–è€…æœ¬åœ°ï¼š

1. å…‹éš†æ­¤ä»“åº“
2. ä½¿ç”¨ `pnpm install` å®‰è£…ä¾èµ–é¡¹
3. ä½¿ç”¨ `pnpm dev` å¯åŠ¨å¼€å‘æœåŠ¡å™¨

## è®¸å¯è¯

[MIT License](https://github.com/nuxt-modules/color-mode/blob/main/LICENSE) 

ç‰ˆæƒæ‰€æœ‰ (c) Nuxt å›¢é˜Ÿ
