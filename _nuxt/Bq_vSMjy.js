import{bC as H,bD as N,w as U,bE as j,G as O,H as F,bF as $,bG as L,d as G,o as w,a as E,p as y,q as V,m as M,s,W as T,bH as Q,bI as X,c as I,a0 as Z,a3 as k,aq as J,e as A,B as v,bJ as K,F as Y,v as ee,bK as R,bL as te,bM as z,bN as oe,ab as q,f as D,al as W,bO as ne,bP as ae,aQ as ie,bQ as se,bR as le}from"./C4zW5aWj.js";let re=0;function ue(o){const t=new WeakMap,u=H();function C(a){if(o.mode!=="popLayout")return;const d=a.offsetParent,f=d instanceof HTMLElement&&d.offsetWidth||0,l={height:a.offsetHeight||0,width:a.offsetWidth||0,top:a.offsetTop,left:a.offsetLeft,right:0};l.right=f-l.width-l.left;const h=o.anchorX==="left"?`left: ${l.left}px`:`right: ${l.right}px`,x=`pop-${re++}`;a.dataset.motionPopId=x;const r=document.createElement("style");u.value.nonce&&(r.nonce=u.value.nonce),t.set(a,r),document.head.appendChild(r),r.sheet&&r.sheet.insertRule(`
    [data-motion-pop-id="${x}"] {
      position: absolute !important;
      width: ${l.width}px !important;
      height: ${l.height}px !important;
      top: ${l.top}px !important;
      ${h} !important;
      }
      `)}function b(a){const d=t.get(a);d&&(t.delete(a),N.render(()=>{document.head.removeChild(d)}))}return{addPopStyle:C,removePopStyle:b}}function ce(o){const t=new Map,u=new Set,{addPopStyle:C,removePopStyle:b}=ue(o);function a(e,i){let n=t.get(e);n||(n={motions:new Set,exitingMotions:new Set,el:e},t.set(e,n)),n.motions.add(i)}function d(e,i){const n=t.get(e);n&&(n.exitingMotions.delete(i),n.exitingMotions.size===0&&n.done&&r(n))}function f(e){u.add(e)}function l(e){u.delete(e)}const h={initial:o.initial,custom:o.custom,register:a,onMotionExitComplete:d,registerPending:f,unregisterPending:l};U(()=>o.custom,e=>{h.custom=e},{flush:"pre"}),j(h),O(()=>{h.initial=void 0});function x(e){if(e instanceof HTMLElement&&!e.hasAttribute(L)){e.setAttribute(L,"");const i=$.get(e);i&&!i.presenceContainer&&(i.presenceContainer=e,a(e,i))}}function r(e){var i,n,g,P,m;b(e.el),e.motions.forEach(c=>{c.getSnapshot(c.options,!1)}),(i=e.done)==null||i.call(e),e.done=void 0,(n=e.el)!=null&&n.isConnected?(P=(g=e.motions.values().next())==null?void 0:g.value)==null||P.didUpdate():(e.motions.forEach(c=>{c.unmount()}),e.motions.clear()),(m=o.onExitComplete)==null||m.call(o)}function S(e,i){x(e);const n=t.get(e);n&&(n.exitingMotions.clear(),n.motions.forEach(g=>{g.setActive("exit",!1),g.getSnapshot(g.options,!0)})),i()}function _(e,i){var n,g,P;const m=e;x(m),u.forEach(p=>{p.element&&m.contains(p.element)&&(p.presenceContainer=m,a(m,p),u.delete(p))});const c=t.get(m),B=$.get(m);if((!c||c.motions.size===0)&&!B){i(),(n=o.onExitComplete)==null||n.call(o);return}c.done=i,C(m),c.motions.forEach(p=>{c.exitingMotions.add(p),p.setActive("exit",!0),p.getSnapshot(p.options,!1)}),(P=(g=c.motions.values().next())==null?void 0:g.value)==null||P.didUpdate()}return F(()=>{t.forEach(e=>{e.motions.forEach(i=>{i.unmount()})}),t.clear()}),{enter:S,exit:_}}const de=G({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(o){const t=o,{enter:u,exit:C}=ce(t),b=I(()=>t.mode!=="wait"?{tag:t.as}:{mode:t.mode==="wait"?"out-in":void 0});return(a,d)=>(w(),E(T(a.mode==="wait"?Q:X),M(b.value,{appear:"",onLeave:s(C),onEnter:s(u)}),{default:y(()=>[V(a.$slots,"default")]),_:3},16,["onLeave","onEnter"]))}}),fe={slots:{base:"rounded-md w-full",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none",zoomedImage:"w-full h-auto max-w-[95vw] max-h-[95vh] object-contain rounded-md"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},me=["onClick"],he=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:null,required:!1}},setup(o){const t=o,u=Z(),[C,b]=k(),[a,d]=k(),f=ee(!1),l=I(()=>W({extend:W(fe),...u.ui?.prose?.img||{}})({zoom:t.zoom,open:f.value})),h=I(()=>{if(t.src?.startsWith("/")&&!t.src.startsWith("//")){const r=ne(ae(ie().app.baseURL));if(r!=="/"&&!t.src.startsWith(r))return se(r,t.src)}return t.src}),x=I(()=>`${h.value}::${le()}`);return t.zoom&&J(window,"scroll",()=>{f.value=!1}),(r,S)=>(w(),A(Y,null,[v(s(C),null,{default:y(()=>[(w(),E(T(s(R)),M({src:h.value,alt:o.alt,width:o.width,height:o.height},r.$attrs,{class:l.value.base({class:[t.ui?.base,t.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),v(s(a),null,{default:y(()=>[(w(),E(T(s(R)),M({src:h.value,alt:o.alt},r.$attrs,{class:l.value.zoomedImage({class:[t.ui?.zoomedImage]})}),null,16,["src","alt","class"]))]),_:1}),o.zoom?(w(),E(s(K),{key:0,open:f.value,"onUpdate:open":S[0]||(S[0]=_=>f.value=_),modal:!1},{default:y(({close:_})=>[v(s(te),{"as-child":""},{default:y(()=>[v(s(z),{"layout-id":x.value,"as-child":"",transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:y(()=>[v(s(b))]),_:1},8,["layout-id"])]),_:1}),v(s(oe),null,{default:y(()=>[v(s(de),null,{default:y(()=>[f.value?(w(),E(s(z),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:q(l.value.overlay({class:[t.ui?.overlay]}))},null,8,["class"])):D("",!0),f.value?(w(),A("div",{key:1,class:q(l.value.content({class:[t.ui?.content]})),onClick:_},[v(s(z),{"as-child":"","layout-id":x.value,transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:y(()=>[v(s(d))]),_:1},8,["layout-id"])],10,me)):D("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(w(),E(s(b),{key:1}))],64))}});export{he as default};
